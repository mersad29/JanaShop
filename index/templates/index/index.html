{% extends 'base.html' %}
{% load static %}
{% load humanize %}
{% load maths %}

{% block slider %}
    <!-- Slider Section -->
    {% include 'includes/slider-section.html' %}
    <!-- /Slider Section -->
{% endblock %}

{% block content %}
    <!-- Featured Products Section -->
    <section id="on-sale-products" class="py-5 mt-5">
        <h1 class="section-title">فروش ویژه</h1>
        <div class="section-subtitle">محصولات دارای تخفیف ویژه به مدت محدود</div>
        <div class="container pt-4">
            <div class="row">
                <div class="col-12 col-lg-6">
                    <div class="on-sale-product-box h-100 p-3" data-aos="fade-zoom-in" data-aos-duration="800">
                        <div class="row h-100">
                            <div class="col-12 col-sm-4 col-lg-5">
                                <a href="{% url 'product:product_detail' fire_sales.first.product.slug %}">
                                    <div class="image h-100"
                                         style="background-image: url('{{ fire_sales.first.product.main_image.url }}')"></div>
                                </a>
                            </div>
                            <div class="col-12 col-sm-8 col-lg-7 py-3">
                                <div class="box-title">محصول ویژه امروز</div>
                                <div class="box-subtitle">فروش به مدت محدود</div>
                                <a href="{% url 'product:product_detail' fire_sales.first.product.slug %}">
                                    <div class="product-title pt-4">{{ fire_sales.first.product.title }}
                                    </div>
                                </a>
                                <div class="price py-2">
                                    <span class="discounted">{{ fire_sales.first.sale_price|intcomma }} تومان</span>
                                    <br class="d-sm-none">
                                    <span class="pre">{{ fire_sales.first.product.price|intcomma }} تومان</span>
                                </div>
                                <div class="cta pt-2">
                                    <a href="{% url 'product:product_detail' fire_sales.first.product.slug %}"
                                       class="hvr-icon-back">همین حالا بخرید <i
                                            class="fa fa-arrow-left hvr-icon"></i></a>
                                </div>
                                <div class="counter mt-3">
                                    <div class="time-counter">
                                        <div class="seconds count">
                                            <div id="end-date"
                                                 style="display: none;">{{ fire_sales.first.end_date|date:'m,d,Y H:i:s' }}</div>
                                            <div class="num">30</div>
                                            <div class="label">ثانیه</div>
                                        </div>
                                        <div class="minutes count">
                                            <div class="num">59</div>
                                            <div class="label">دقیقه</div>
                                        </div>
                                        <div class="hours count">
                                            <div class="num">13</div>
                                            <div class="label">ساعت</div>
                                        </div>
                                        <div class="days count">
                                            <div class="num">38</div>
                                            <div class="label">روز</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-12 col-sm-6 col-lg-3">
                    <!-- Product Box -->
                    <div class="product-box">
                        <a href="{% url 'product:product_detail' fire_sales.1.product.slug %}">
                            <div class="image"
                                 style="background-image: url('{{ fire_sales.1.product.main_image.url }}')">
                                <span class="badge on-sale-badge">فروش ویژه</span>
                            </div>
                        </a>
                        <div class="details p-3">
                            <div class="category">
                                <a href="./products.html">گوشی موبایل</a>
                                &nbsp;/&nbsp;
                                <a href="./products.html">سامسونگ</a>
                            </div>
                            <a href="{% url 'product:product_detail' fire_sales.1.product.slug %}">
                                <h2>{{ fire_sales.1.product.title }}</h2>
                            </a>
                            <div>
                                <span class="discounted">{{ fire_sales.1.product.price|intcomma }} تومان</span>
                                <br class="d-sm-none">
                                <span class="price">{{ fire_sales.1.product.final_price|intcomma }} تومان</span>
                            </div>
                            <div class="rate">
                                {% for _ in  fire_sales.1.product.star|to_range %}
                                    <i class="fa-solid fa-star" style="color: #FFD43B;"></i>
                                {% endfor %}
                                {% for _ in fire_sales.1.product.empty_star|to_range %}
                                    <i class="fa-regular fa-star" style="color: #FFD43B;"></i>
                                {% endfor %}
                                <span class="reviews">({{ item.comment_count }} رای دهنده)</span>
                            </div>
                        </div>
                    </div>
                    <!-- /Product Box -->
                </div>
                <div class="col-12 col-sm-6 col-lg-3">
                    <!-- Product Box -->
                    <div class="product-box">
                        <a href="{% url 'product:product_detail' fire_sales.2.product.slug %}">
                            <div class="image"
                                 style="background-image: url('{{ fire_sales.1.product.main_image.url }}')">
                                <span class="badge on-sale-badge">فروش ویژه</span>
                            </div>
                        </a>
                        <div class="details p-3">
                            <div class="category">
                                <a href="./products.html">گوشی موبایل</a>
                                &nbsp;/&nbsp;
                                <a href="./products.html">سامسونگ</a>
                            </div>
                            <a href="{% url 'product:product_detail' fire_sales.2.product.slug %}">
                                <h2>{{ fire_sales.2.product.title }}</h2></a>
                            <div>
                                <span class="discounted">{{ fire_sales.2.product.price|intcomma }} تومان</span>
                                <br class="d-sm-none">
                                <span class="price">{{ fire_sales.1.product.final_price|intcomma }} تومان</span>
                            </div>
                            <div class="rate">
                                {% for _ in  fire_sales.2.product.star|to_range %}
                                    <i class="fa-solid fa-star" style="color: #FFD43B;"></i>
                                {% endfor %}
                                {% for _ in fire_sales.2.product.empty_star|to_range %}
                                    <i class="fa-regular fa-star" style="color: #FFD43B;"></i>
                                {% endfor %}
                                <span class="reviews">({{ item.comment_count }} رای دهنده)</span>
                            </div>
                        </div>
                    </div>
                    <!-- /Product Box -->
                </div>
            </div>
        </div>
    </section>
    <!-- /Featured Products Section -->

    <!-- On Sale Products -->
    <section id="featured-products" class="my-5">
        <div class="container">
            <!-- Tabs -->
            <div class="row pb-2 pb-sm-4">
                <div class="col-12 text-center">
                    <div class="btn-group" role="group" id="featured-products-nav">
                        <button type="button" class="btn active featured-categories" data-val="featured">تخفیف خورده
                        </button>
                        {#                        <button type="button" class="btn featured-categories" data-val="on-sale">تخفیف خورده</button>#}
                        <button type="button" class="btn featured-categories" data-val="most-visited">پربازدیدترین
                        </button>
                    </div>
                </div>
            </div>
            <!-- /Tabs -->

            <!-- Products -->
            <div class="row row-cols-1 row-cols-sm-2 row-cols-lg-4 g-md-4 featured-product featured" data-aos="fade-up"
                 data-aos-duration="1000">
                {% for item in most_off %}
                    <div class="col">
                        <!-- Product Box -->
                        <div class="col">
                            <!-- Product Box -->
                            <div class="product-box">
                                <a href="{% url 'product:product_detail' item.slug %}">
                                    <div class="image"
                                         style="background-image: url('{{ item.main_image.url }}')"></div>
                                </a>
                                <a href="{% if item.liked %} {% url 'index:delete_favorite' item.id %}  {% else %} {% url 'index:add_favorite' item.id %} {% endif %}">
                                    <div class="icons">
                                        <div class="btn btn-outline-secondary {% if item.liked %} btn-favorited {% else %} btn-favorite {% endif %}">
                                        </div>
                                    </div>
                                </a>
                                <div class="details p-3">
                                    <div class="category">
                                        <a href="./products.html">گوشی موبایل</a>
                                        &nbsp;/&nbsp;
                                        <a href="./products.html">سامسونگ</a>
                                    </div>
                                    <a href="{% url 'product:product_detail' item.slug %}"><h2>{{ item.title }}</h2></a>
                                    <div>
                                        <span class="discounted">{{ item.price|intcomma }} تومان</span>
                                        <br class="d-sm-none">
                                        <span class="price">{{ item.final_price|intcomma }} تومان</span>
                                    </div>
                                    <div class="rate">
                                        {% for _ in  item.star|to_range %}
                                            <i class="fa-solid fa-star" style="color: #FFD43B;"></i>
                                        {% endfor %}
                                        {% for _ in item.empty_star|to_range %}
                                            <i class="fa-regular fa-star" style="color: #FFD43B;"></i>
                                        {% endfor %}
                                        <span class="reviews">({{ item.comment_count }} رای دهنده)</span>
                                    </div>
                                </div>
                            </div>
                            <!-- /Product Box -->
                        </div>
                        <!-- /Product Box -->
                    </div>
                {% endfor %}
            </div>

            <div class="row row-cols-1 row-cols-sm-2 row-cols-lg-4 g-md-4 featured-product on-sale">
                {% for item in most_view %}
                    <div class="col">
                        <!-- Product Box -->
                        <div class="product-box">
                            <a href="./product.html">
                                <div class="image" style="background-image: url('assets/images/products/p303.png')">
                                    <span class="badge on-sale-badge">فروش ویژه</span>
                                </div>
                            </a>
                            <div class="details p-3">
                                <div class="category">
                                    <a href="./products.html">گوشی موبایل</a>
                                    &nbsp;/&nbsp;
                                    <a href="./products.html">سامسونگ</a>
                                </div>
                                <a href="./product.html"><h2>{{ item.title }}</h2>
                                </a>
                                <div>
                                    <span class="discounted">{{ item.price|intcomma|intcomma }} تومان</span>
                                    <br class="d-sm-none">
                                    <span class="price">{{ item.final_price|intcomma }} تومان</span>
                                </div>
                                <div class="rate">
                                    {% for _ in  item.star|to_range %}
                                        <i class="fa-solid fa-star" style="color: #FFD43B;"></i>
                                    {% endfor %}
                                    {% for _ in item.empty_star|to_range %}
                                        <i class="fa-regular fa-star" style="color: #FFD43B;"></i>
                                    {% endfor %}
                                    <span class="reviews">(14 رای دهنده)</span>
                                </div>
                            </div>
                        </div>
                        <!-- /Product Box -->
                    </div>
                {% endfor %}
            </div>

            <div class="row row-cols-1 row-cols-sm-2 row-cols-lg-4 g-md-4 featured-product most-visited">
                {% for item in most_view %}
                    <div class="col">
                        <!-- Product Box -->
                        <div class="product-box">
                            <a href="{% url 'product:product_detail' item.slug %}">
                                <div class="image" style="background-image: url('{{ item.main_image.url }}')">
                                </div>
                            </a>
                            <a href="{% if item.liked %} {% url 'index:delete_favorite' item.id %}  {% else %} {% url 'index:add_favorite' item.id %} {% endif %}">
                                <div class="icons">
                                    <div class="btn btn-outline-secondary {% if item.liked %} btn-favorited {% else %} btn-favorite {% endif %}">
                                    </div>
                                </div>
                            </a>
                            <div class="details p-3">
                                <div class="category">
                                    <a href="./products.html">گوشی موبایل</a>
                                    &nbsp;/&nbsp;
                                    <a href="./products.html">سامسونگ</a>
                                </div>
                                <a href="./product.html"><h2>{{ item.title }}</h2>
                                </a>
                                <div>
                                    <span class="discounted">{{ item.price|intcomma }} تومان</span>
                                    <br class="d-sm-none">
                                    <span class="price">{{ item.final_price|intcomma }} تومان</span>
                                </div>
                                <div class="rate">
                                    {% for _ in  item.star|to_range %}
                                        <i class="fa-solid fa-star" style="color: #FFD43B;"></i>
                                    {% endfor %}
                                    {% for _ in item.empty_star|to_range %}
                                        <i class="fa-regular fa-star" style="color: #FFD43B;"></i>
                                    {% endfor %}
                                    <span class="reviews">({{ item.comment_count }} رای دهنده)</span>
                                </div>
                            </div>
                        </div>
                        <!-- /Product Box -->
                    </div>
                {% endfor %}
            </div>
            <!-- /Products -->
        </div>
    </section>
    <!-- /On Sale Products -->

    <!-- Benefits Section -->
    <section id="benefits" class="pt-4">
        <div class="container">
            <div class="row row-cols-1 row-cols-sm-2 row-cols-lg-4 gy-3 text-center">
                <div class="col" data-aos="fade-zoom-in" data-aos-duration="800">
                    <img src="assets/images/benefits/benefit1.png" alt="">
                    <span>پشتیبانی 24 ساعته</span>
                </div>
                <div class="col" data-aos="fade-zoom-in" data-aos-duration="1000">
                    <img src="assets/images/benefits/benefit2.png" alt="">
                    <span>ضمانت اصالت کالا</span>
                </div>
                <div class="col" data-aos="fade-zoom-in" data-aos-duration="1200">
                    <img src="assets/images/benefits/benefit3.png" alt="">
                    <span>ضمانت بازگشت وجه</span>
                </div>
                <div class="col" data-aos="fade-zoom-in" data-aos-duration="1400">
                    <img src="assets/images/benefits/benefit4.png" alt="">
                    <span>ارسال سریع و رایگان</span>
                </div>
            </div>
            <div class="row pt-2">
                <div class="col">
                    <hr>
                </div>
            </div>
        </div>
    </section>
    <!-- /Benefits Section -->

    <!-- Most Sales Products -->
    <section id="most-sales-products" class="pt-4">
        <h1 class="section-title">پرفروش ترین محصولات</h1>
        <div class="container pt-4">
            <!-- Tabs -->
            <div class="row pb-2 pb-sm-4">
                <div class="col-12 text-center">
                    <div class="btn-group" role="group" id="most-sales-products-nav">
                        {% for cat in featured_cats %}
                            <button type="button" class="btn active most-sales-categories"
                                    data-val="{{ cat.category.id }}">{{ cat.category.title }}
                            </button>
                        {% endfor %}
                    </div>
                </div>
            </div>
            <!-- /Tabs -->

            <!-- Products -->
            {% for cat in featured_cats %}
                <div class="row row-cols-1 row-cols-sm-2 row-cols-lg-4 g-md-4 most-sales-product {{ cat.category.id }}" data-aos="fade-up"
                 data-aos-duration="1000">
                {% for item in cat.products %}
                    <div class="col">
                        <!-- Product Box -->
                        <div class="col">
                            <!-- Product Box -->
                            <div class="col">
                                <!-- Product Box -->
                                <div class="product-box">
                                    <a href="{% url 'product:product_detail' item.slug %}">
                                        <div class="image"
                                             style="background-image: url('{{ item.main_image.url }}')"></div>
                                    </a>
                                    <a href="{% if item.liked %} {% url 'index:delete_favorite' item.id %}  {% else %} {% url 'index:add_favorite' item.id %} {% endif %}">
                                        <div class="icons">
                                            <div class="btn btn-outline-secondary {% if item.liked %} btn-favorited {% else %} btn-favorite {% endif %}">
                                            </div>
                                        </div>
                                    </a>
                                    <div class="details p-3">
                                        <div class="category">
                                            <a href="./products.html">گوشی موبایل</a>
                                            &nbsp;/&nbsp;
                                            <a href="./products.html">سامسونگ</a>
                                        </div>
                                        <a href="{% url 'product:product_detail' item.slug %}"><h2>{{ item.title }}</h2>
                                        </a>
                                        <div>
                                            <span class="discounted">{{ item.price|intcomma }} تومان</span>
                                            <br class="d-sm-none">
                                            <span class="price">{{ item.final_price|intcomma }} تومان</span>
                                        </div>
                                        <div class="rate">
                                            {% for _ in  item.star|to_range %}
                                                <i class="fa-solid fa-star" style="color: #FFD43B;"></i>
                                            {% endfor %}
                                            {% for _ in item.empty_star|to_range %}
                                                <i class="fa-regular fa-star" style="color: #FFD43B;"></i>
                                            {% endfor %}
                                            <span class="reviews">({{ item.comment_count }} رای دهنده)</span>
                                        </div>
                                    </div>
                                </div>
                                <!-- /Product Box -->
                            </div>
                            <!-- /Product Box -->
                        </div>
                        <!-- /Product Box -->
                    </div>
                {% endfor %}
            </div>
            {% endfor %}
            <!-- /Products -->
        </div>
    </section>
    <!-- /Most Sales Products -->

    <!-- Promo Images -->
    {% include 'includes/mid-banners.html' %}
    <!-- /Promo Images -->
{% endblock %}